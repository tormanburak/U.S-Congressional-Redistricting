var statesData = {
    "type": "FeatureCollection", "features": [
        {
            "type": "Feature",
            "id": "21",
            "properties": {"name": "KY", "density": 110, "color": "red"},
            "geometry": {
                "type": "Polygon",
                "coordinates": [[[-83.903347, 38.769315], [-83.678792, 38.632391], [-83.519961, 38.703591], [-83.142052, 38.626914], [-83.032514, 38.725499], [-82.890113, 38.758361], [-82.846298, 38.588575], [-82.731282, 38.561191], [-82.594358, 38.424267], [-82.621743, 38.123036], [-82.50125, 37.931343], [-82.342419, 37.783465], [-82.293127, 37.668449], [-82.101434, 37.553434], [-81.969987, 37.537003], [-82.353373, 37.268633], [-82.720328, 37.120755], [-82.720328, 37.044078], [-82.868205, 36.978355], [-82.879159, 36.890724], [-83.070852, 36.852385], [-83.136575, 36.742847], [-83.673316, 36.600446], [-83.689746, 36.584015], [-84.544149, 36.594969], [-85.289013, 36.627831], [-85.486183, 36.616877], [-86.592525, 36.655216], [-87.852221, 36.633308], [-88.071299, 36.677123], [-88.054868, 36.496384], [-89.298133, 36.507338], [-89.418626, 36.496384], [-89.363857, 36.622354], [-89.215979, 36.578538], [-89.133825, 36.983832], [-89.183118, 37.038601], [-89.029763, 37.213863], [-88.914747, 37.224817], [-88.547792, 37.071463], [-88.421823, 37.153617], [-88.514931, 37.285064], [-88.476592, 37.389126], [-88.065822, 37.482234], [-88.15893, 37.657496], [-88.027483, 37.799896], [-87.934375, 37.893004], [-87.682436, 37.903958], [-87.600282, 37.975158], [-87.512651, 37.903958], [-87.381204, 37.93682], [-87.129265, 37.788942], [-87.047111, 37.893004], [-86.795172, 37.991589], [-86.729448, 37.893004], [-86.504894, 37.931343], [-86.521325, 38.040881], [-86.302247, 38.166851], [-86.263908, 38.051835], [-86.039354, 37.958727], [-85.924338, 38.024451], [-85.83123, 38.27639], [-85.655968, 38.325682], [-85.590245, 38.451652], [-85.42046, 38.533806], [-85.431413, 38.730976], [-85.173997, 38.68716], [-84.987781, 38.780268], [-84.812519, 38.785745], [-84.894673, 39.059592], [-84.817996, 39.103408], [-84.43461, 39.103408], [-84.231963, 38.895284], [-84.215533, 38.807653], [-83.903347, 38.769315]]]
            }
        },
        {
            "type": "Feature",
            "id": "22",
            "properties": {"name": "LA", "density": 105, "color": "blue"},
            "geometry": {
                "type": "Polygon",
                "coordinates": [[[-93.608485, 33.018527], [-91.16577, 33.002096], [-91.072662, 32.887081], [-91.143862, 32.843265], [-91.154816, 32.640618], [-91.006939, 32.514649], [-90.985031, 32.218894], [-91.105524, 31.988862], [-91.341032, 31.846462], [-91.401278, 31.621907], [-91.499863, 31.643815], [-91.516294, 31.27686], [-91.636787, 31.265906], [-91.565587, 31.068736], [-91.636787, 30.997536], [-89.747242, 30.997536], [-89.845827, 30.66892], [-89.681519, 30.449842], [-89.643181, 30.285534], [-89.522688, 30.181472], [-89.818443, 30.044549], [-89.84035, 29.945964], [-89.599365, 29.88024], [-89.495303, 30.039072], [-89.287179, 29.88024], [-89.30361, 29.754271], [-89.424103, 29.699501], [-89.648657, 29.748794], [-89.621273, 29.655686], [-89.69795, 29.513285], [-89.506257, 29.387316], [-89.199548, 29.348977], [-89.09001, 29.2011], [-89.002379, 29.179192], [-89.16121, 29.009407], [-89.336472, 29.042268], [-89.484349, 29.217531], [-89.851304, 29.310638], [-89.851304, 29.480424], [-90.032043, 29.425654], [-90.021089, 29.283254], [-90.103244, 29.151807], [-90.23469, 29.129899], [-90.333275, 29.277777], [-90.563307, 29.283254], [-90.645461, 29.129899], [-90.798815, 29.086084], [-90.963123, 29.179192], [-91.09457, 29.190146], [-91.220539, 29.436608], [-91.445094, 29.546147], [-91.532725, 29.529716], [-91.620356, 29.73784], [-91.883249, 29.710455], [-91.888726, 29.836425], [-92.146142, 29.715932], [-92.113281, 29.622824], [-92.31045, 29.535193], [-92.617159, 29.579009], [-92.97316, 29.715932], [-93.2251, 29.776178], [-93.767317, 29.726886], [-93.838517, 29.688547], [-93.926148, 29.787132], [-93.690639, 30.143133], [-93.767317, 30.334826], [-93.696116, 30.438888], [-93.728978, 30.575812], [-93.630393, 30.679874], [-93.526331, 30.93729], [-93.542762, 31.15089], [-93.816609, 31.556184], [-93.822086, 31.775262], [-94.041164, 31.994339], [-94.041164, 33.018527], [-93.608485, 33.018527]]]
            }
        },
        {
            "type": "Feature",
            "id": "48",
            "properties": {"name": "TX", "density": 98.07, "color": "red"},
            "geometry": {
                "type": "Polygon",
                "coordinates": [[[-101.812942, 36.501861], [-100.000075, 36.501861], [-100.000075, 34.563024], [-99.923398, 34.573978], [-99.698843, 34.382285], [-99.57835, 34.415147], [-99.260688, 34.404193], [-99.189488, 34.2125], [-98.986841, 34.223454], [-98.767763, 34.135823], [-98.570593, 34.146777], [-98.488439, 34.064623], [-98.36247, 34.157731], [-98.170777, 34.113915], [-98.088623, 34.004376], [-97.946222, 33.987946], [-97.869545, 33.851022], [-97.694283, 33.982469], [-97.458774, 33.905791], [-97.371143, 33.823637], [-97.256128, 33.861976], [-97.173974, 33.736006], [-96.922034, 33.960561], [-96.850834, 33.845545], [-96.631756, 33.845545], [-96.423633, 33.774345], [-96.346956, 33.686714], [-96.149786, 33.840068], [-95.936185, 33.889361], [-95.8376, 33.834591], [-95.602092, 33.933176], [-95.547322, 33.878407], [-95.289906, 33.87293], [-95.224183, 33.960561], [-94.966767, 33.861976], [-94.868182, 33.74696], [-94.484796, 33.637421], [-94.380734, 33.544313], [-94.183564, 33.593606], [-94.041164, 33.54979], [-94.041164, 33.018527], [-94.041164, 31.994339], [-93.822086, 31.775262], [-93.816609, 31.556184], [-93.542762, 31.15089], [-93.526331, 30.93729], [-93.630393, 30.679874], [-93.728978, 30.575812], [-93.696116, 30.438888], [-93.767317, 30.334826], [-93.690639, 30.143133], [-93.926148, 29.787132], [-93.838517, 29.688547], [-94.002825, 29.68307], [-94.523134, 29.546147], [-94.70935, 29.622824], [-94.742212, 29.787132], [-94.873659, 29.672117], [-94.966767, 29.699501], [-95.016059, 29.557101], [-94.911997, 29.496854], [-94.895566, 29.310638], [-95.081782, 29.113469], [-95.383014, 28.867006], [-95.985477, 28.604113], [-96.045724, 28.647929], [-96.226463, 28.582205], [-96.23194, 28.642452], [-96.478402, 28.598636], [-96.593418, 28.724606], [-96.664618, 28.697221], [-96.401725, 28.439805], [-96.593418, 28.357651], [-96.774157, 28.406943], [-96.801542, 28.226204], [-97.026096, 28.039988], [-97.256128, 27.694941], [-97.404005, 27.333463], [-97.513544, 27.360848], [-97.540929, 27.229401], [-97.425913, 27.262263], [-97.480682, 26.99937], [-97.557359, 26.988416], [-97.562836, 26.840538], [-97.469728, 26.758384], [-97.442344, 26.457153], [-97.332805, 26.353091], [-97.30542, 26.161398], [-97.217789, 25.991613], [-97.524498, 25.887551], [-97.650467, 26.018997], [-97.885976, 26.06829], [-98.198161, 26.057336], [-98.466531, 26.221644], [-98.669178, 26.238075], [-98.822533, 26.369522], [-99.030656, 26.413337], [-99.173057, 26.539307], [-99.266165, 26.840538], [-99.446904, 27.021277], [-99.424996, 27.174632], [-99.50715, 27.33894], [-99.479765, 27.48134], [-99.605735, 27.640172], [-99.709797, 27.656603], [-99.879582, 27.799003], [-99.934351, 27.979742], [-100.082229, 28.14405], [-100.29583, 28.280974], [-100.399891, 28.582205], [-100.498476, 28.66436], [-100.629923, 28.905345], [-100.673738, 29.102515], [-100.799708, 29.244915], [-101.013309, 29.370885], [-101.062601, 29.458516], [-101.259771, 29.535193], [-101.413125, 29.754271], [-101.851281, 29.803563], [-102.114174, 29.792609], [-102.338728, 29.869286], [-102.388021, 29.765225], [-102.629006, 29.732363], [-102.809745, 29.524239], [-102.919284, 29.190146], [-102.97953, 29.184669], [-103.116454, 28.987499], [-103.280762, 28.982022], [-103.527224, 29.135376], [-104.146119, 29.381839], [-104.266611, 29.513285], [-104.507597, 29.639255], [-104.677382, 29.924056], [-104.688336, 30.181472], [-104.858121, 30.389596], [-104.896459, 30.570335], [-105.005998, 30.685351], [-105.394861, 30.855136], [-105.602985, 31.085167], [-105.77277, 31.167321], [-105.953509, 31.364491], [-106.205448, 31.468553], [-106.38071, 31.731446], [-106.528588, 31.786216], [-106.643603, 31.901231], [-106.616219, 31.999816], [-103.067161, 31.999816], [-103.067161, 33.002096], [-103.045254, 34.01533], [-103.039777, 36.501861], [-103.001438, 36.501861], [-101.812942, 36.501861]]]
            }
        },
    ]
};
var districtsData = {"type": "FeatureCollection", "features": []};
var statesData2 = {"type": "FeatureCollection", "features": []};
var precinctsData = {"type": "FeatureCollection", "features": []};
var colorSet = [
    ['#ffb3b3', '#ff8080', '#ff4d4d', '#ff1a1a', '#e60000', '#b30000', '#8b0000', '#660000'],
    ['#ccccff', '#9999ff', '#6666ff', '#3333ff', '#0000ff', '#0000cc', '#000099', '#000066'],
    ['#f2f2f2', '#d9d9d9', '#bfbfbf', '#a9a9a9', '#999999', '#808080', '#666666', '#696969']
];
var districtColorSet = [
    ["#ffcccc", "#ff8080", "#ff3333", "#e60000", "#990000"],
    ["#ccccff", "#6666ff", "#1a1aff", "#0000cc", "#000080"],
    ["#f2f2f2", '#bfbfbf', '#999999', '#666666', '#262626']
];
var clusterColorSet = ["#FF69B4", "#FAFAD2", "#00FFFF", "#7FFFD4",
    "#7CFC00", "#ADD8E6", "#F08080", "#DAA520",
    "#0000FF", "#8A2BE2", "#A52A2A", "#DEB887",
    "#5F9EA0", "#7FFF00", "#D2691E", "#FF7F50",
    "#6495ED", "#E0FFFF", "#DC143C", "#00FFFF",
    "#00008B", "#008B8B", "#B8860B", "#A9A9A9",
    "#006400", "#BDB76B", "#8B008B", "#556B2F",
    "#FF8C00", "#9932CC", "#8B0000", "#E9967A",
    "#8FBC8F", "#483D8B", "#2F4F4F", "#00CED1",
    "#9400D3", "#FF1493", "#00BFFF", "#696969",
    "#1E90FF", "#B22222", "#D3D3D3", "#228B22",
    "#FF00FF", "#DCDCDC", "#F8F8FF", "#FFD700",
    "#FFEBCD", "#808080", "#808080", "#008000",
    "#ADFF2F", "#90EE90", "#FFB6C1", "#CD5C5C",
    "#4B0082", "#FFFFF0", "#20B2AA", "#FFA07A",
    "black"
];


function getStateColor(feature) {
    if(feature.properties.name == "KY") { feature.properties["color"] = "red"; return "red"; }
    else if(feature.properties.name == "TX") { feature.properties["color"] = "red"; return "red"; }
    else { feature.properties["color"] = "red"; return "red"; }
}

function stateStyle(feature) {
    return {
        fillColor: "red",
        //fillColor: getStateColor(feature),
        weight: 1,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.6
    };
}

function districtStyle(feature){
    var selectedTheme = document.getElementById('colorTheme').value;
    var colorIndex;

    if(selectedTheme == "Red") colorIndex = 0;
    else if(selectedTheme == "Blue") colorIndex = 1;
    else colorIndex = 2;

    return {
        fillColor: districtColorSet[colorIndex][feature.color],
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7
    };
}

function getPrecinctColor(d) {
    var selectedTheme = document.getElementById('colorTheme').value;
    var colorIndex;

    if(selectedTheme == "Red") colorIndex = 0;
    else if(selectedTheme == "Blue") colorIndex = 1;
    else colorIndex = 2;

    return d >= 2000 ? colorSet[colorIndex][7] :
        d >= 1750  ? colorSet[colorIndex][6] :
            d >= 1500  ? colorSet[colorIndex][5] :
                d >= 1250  ? colorSet[colorIndex][4] :
                    d >= 700   ? colorSet[colorIndex][3] :
                        d >= 300   ? colorSet[colorIndex][2] :
                            d >= 100   ? colorSet[colorIndex][1] :
                                colorSet[colorIndex][0];
}

function precinctStyle(feature) {
    return {
        fillColor: getPrecinctColor(feature.demProperties.totalPopulation),
        weight: 2,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.7
    };
}

function phase1Style(feature){
    var selectedTheme = document.getElementById('colorTheme').value;
    var colorIndex;

    if(selectedTheme == "Red") colorIndex = 0;
    else if(selectedTheme == "Blue") colorIndex = 1;
    else colorIndex = 2;
    debugger;
    //  if(feature.precinctID> 1000) {
    return {
        fillColor: clusterColorSet[myColorMap[String(myMap2[String(feature.precinctID)])]],
        weight: 2,
        opacity: 0.7,
        color: clusterColorSet[myColorMap[String(myMap2[String(feature.precinctID)])]],
        dashArray: '',
        fillOpacity: 1
    };


}

function phase2Style(feature){
    console.log("phase2Style");
    if(phase2moves[index].makeMove){
        if(feature.precinctID == phase2moves[index].pickedPrecinctID){
            myMap2[String(feature.precinctID)] = phase2moves[index].targetDistrictID;
            return {
                fillColor: clusterColorSet[myColorMap[String(phase2moves[index].targetDistrictID)]],
                weight: 2,
                opacity: 0.7,
                color: 'black',
                dashArray: '',
                fillOpacity: 1
            };
        }else{
            console.log("others");
            return {
                fillColor: clusterColorSet[myColorMap[String(myMap2[String(feature.precinctID)])]],
                weight: 2,
                opacity: 0.7,
                color: clusterColorSet[myColorMap[String(myMap2[String(feature.precinctID)])]],
                dashArray: '',
                fillOpacity: 1
            };
        }
    }else{
        console.log("false");
        return {
            fillColor: clusterColorSet[myColorMap[String(myMap2[String(feature.precinctID)])]],
            weight: 2,
            opacity: 0.7,
            color: clusterColorSet[myColorMap[String(myMap2[String(feature.precinctID)])]],
            dashArray: '',
            fillOpacity: 1
        };
    }
}

/*
function mergeDistrictStyle(feature){
    var min = Math.ceil(0);
    var max = Math.floor(7);
    var rand = Math.floor(Math.random() * (max - min)) + min;

    var selectedTheme = document.getElementById('colorTheme').value;
    var colorIndex;

    if(selectedTheme == "Red") colorIndex = 0;
    else if(selectedTheme == "Blue") colorIndex = 1;
    else colorIndex = 2;

    return {
        fillColor: colorSet[colorIndex][rand],
        weight: 1,
        opacity: 1,
        color: 'white',
        dashArray: '3',
        fillOpacity: 0.6
    };
}
 */

function zoom(){
    for (var i = 0; i < statesData.features.length; i++) {
        if (document.getElementById("dropdown").value == statesData.features[i].properties.name) {
            var maxLng = statesData.features[i].geometry.coordinates[0][0][0];
            var maxLat = statesData.features[i].geometry.coordinates[0][0][1];
            var minLng = statesData.features[i].geometry.coordinates[0][0][0];
            var minLat = statesData.features[i].geometry.coordinates[0][0][1];
            for (var j = 0; j < statesData.features[i].geometry.coordinates[0].length; j++) {
                if (maxLng < statesData.features[i].geometry.coordinates[0][j][0]) {
                    maxLng = statesData.features[i].geometry.coordinates[0][j][0];
                }
                if (minLng > statesData.features[i].geometry.coordinates[0][j][0]) {
                    minLng = statesData.features[i].geometry.coordinates[0][j][0];
                }
                if (maxLat < statesData.features[i].geometry.coordinates[0][j][1]) {
                    maxLat = statesData.features[i].geometry.coordinates[0][j][1];
                }
                if (minLat > statesData.features[i].geometry.coordinates[0][j][1]) {
                    minLat = statesData.features[i].geometry.coordinates[0][j][1];
                }
            }

            var northEast = L.latLng(maxLat, maxLng);
            var southWest = L.latLng(minLat, minLng);
            var bounds = L.latLngBounds(northEast, southWest);

            map.fitBounds(bounds);
            map.setMaxBounds(bounds);
            break;

        }
    }
}

function changeMapData(data){
    if (document.getElementById("dropdown").value == "Default") {
        map.remove();
        map = L.map('map').setView([38.5, -96], 5);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        geojson = L.geoJson(statesData, {
            style: stateStyle,
            onEachFeature: onEachFeatureForState
        }).addTo(map);
        legend.remove(map);
    }
    else {
        geojson.clearLayers();
        if(phase2Btn){
            console.log("changeMapData");
            geojson = L.geoJson(data, {
                style: phase2Style,
                onEachFeature: onEachFeatureForPrecinctOrDistrict
            }).addTo(map);
            console.log("end changeMapData");
        }
        else if(phase1Btn){
            geojson = L.geoJson(data, {
                style: phase1Style,
                onEachFeature: onEachFeatureForPrecinctOrDistrict
            }).addTo(map);
        }else{
            if(!precinctBtn && !districtBtn) {
                geojson = L.geoJson(data, {
                    style: stateStyle,
                    onEachFeature: onEachFeatureForState
                }).addTo(map);
                legend.remove(map);
            }else if(precinctBtn){
                geojson = L.geoJson(data, {
                    style: precinctStyle,
                    onEachFeature: onEachFeatureForPrecinctOrDistrict
                }).addTo(map);
                legend.onAdd = function (map) {
                    var div = L.DomUtil.create('div', 'info legend'),
                        grades = [0, 100, 300, 700, 1250, 1500, 1750, 2000],
                        labels = [];

                    // loop through our density intervals and generate a label with a colored square for each interval
                    for (var i = 0; i < grades.length; i++) {
                        div.innerHTML +=
                            '<i style="background:' + getPrecinctColor(grades[i] + 1) + '"></i> ' +
                            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
                    }
                    return div;
                };
                legend.addTo(map);
            }
            else{
                geojson = L.geoJson(data, {
                    style: districtStyle,
                    onEachFeature: onEachFeatureForPrecinctOrDistrict
                }).addTo(map);
                legend.remove(map);
            }
        }
    }
}

function changeMapDataDependingOnZoomLevel(data){
    if (document.getElementById("dropdown").value == "Default") {
        map.remove();
        map = L.map('map').setView([38.5, -96], 5);
        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);
        geojson = L.geoJson(statesData, {
            style: stateStyle,
            onEachFeature: onEachFeatureForState
        }).addTo(map);
        legend.remove(map);
    }
    else {
        geojson.clearLayers();
        if(document.getElementById("dropdown").value == "TX"){
            if(map.getZoom() >= 8){
                geojson = L.geoJson(precinctsData, {
                    style: precinctStyle,
                    onEachFeature: onEachFeatureForPrecinctOrDistrict
                }).addTo(map);
                legend.onAdd = function (map) {
                    var div = L.DomUtil.create('div', 'info legend'),
                        grades = [0, 100, 300, 700, 1250, 1500, 1750, 2000],
                        labels = [];

                    // loop through our density intervals and generate a label with a colored square for each interval
                    for (var i = 0; i < grades.length; i++) {
                        div.innerHTML +=
                            '<i style="background:' + getPrecinctColor(grades[i] + 1) + '"></i> ' +
                            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
                    }
                    return div;
                };
                legend.addTo(map);
            }else if(map.getZoom() >= 6){
                geojson = L.geoJson(districtsData, {
                    style: districtStyle,
                    onEachFeature: onEachFeatureForPrecinctOrDistrict
                }).addTo(map);
                legend.remove(map);
            }else{
                geojson = L.geoJson(statesData, {
                    style: stateStyle,
                    onEachFeature: onEachFeatureForState
                }).addTo(map);
                legend.remove(map);
            }
        }else{
            if(map.getZoom() >= 9){
                geojson = L.geoJson(precinctsData, {
                    style: precinctStyle,
                    onEachFeature: onEachFeatureForPrecinctOrDistrict
                }).addTo(map);
                legend.onAdd = function (map) {
                    var div = L.DomUtil.create('div', 'info legend'),
                        grades = [0, 100, 300, 700, 1250, 1500, 1750, 2000],
                        labels = [];

                    // loop through our density intervals and generate a label with a colored square for each interval
                    for (var i = 0; i < grades.length; i++) {
                        div.innerHTML +=
                            '<i style="background:' + getPrecinctColor(grades[i] + 1) + '"></i> ' +
                            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
                    }
                    return div;
                };
                legend.addTo(map);
            }else if(map.getZoom() >= 7){
                geojson = L.geoJson(districtsData, {
                    style: districtStyle,
                    onEachFeature: onEachFeatureForPrecinctOrDistrict
                }).addTo(map);
                legend.remove(map);
            }else{
                geojson = L.geoJson(statesData, {
                    style: stateStyle,
                    onEachFeature: onEachFeatureForState
                }).addTo(map);
                legend.remove(map);
            }
        }
    }
}

function onEachFeatureForState(feature, layer) {
    layer.on({
        click: clickOnState
    });
}

function onEachFeatureForPrecinctOrDistrict(feature, layer) {
    layer.on({
        mouseover: function () {
            if(!phase2Btn){
                displayCharts(feature);
                if(phase1TableStatus){
                    clearTable2();
                }
            }
        },
        mouseout: function(){
            if(!phase2Btn){
                clearCharts();
                if(phase1Btn){
                    displayStatePopTable(stateTableData);
                    displayDistrictPopTable(districtTableData);
                }
            }
        },
    });
}

function clickOnState(e) {
    document.getElementById("dropdown").value = e.target.feature.properties.name;
    if(document.getElementById("dropdown").value == "KY"){
        document.getElementById("dropdown-button").getElementsByTagName("span")[0].innerHTML = "Kentucky";
    }else if(document.getElementById("dropdown").value == "LA"){
        document.getElementById("dropdown-button").getElementsByTagName("span")[0].innerHTML = "Louisiana";
    }else if(document.getElementById("dropdown").value == "TX"){
        document.getElementById("dropdown-button").getElementsByTagName("span")[0].innerHTML = "Texas";
    }else{
        document.getElementById("dropdown-button").getElementsByTagName("span")[0].innerHTML = "Select a state";
    }
    setUpForTheSelectedState();
}

function displayCharts(feature) {
    if(!tableStatus){
        document.getElementById("district-precinct-chart-title").style.display = "block";
        if(phase1Btn){
            showBothStateCharts();
            google.charts.setOnLoadCallback(function () {drawVotingChart(feature);});
            google.charts.setOnLoadCallback(function () {displayDemo(feature);});
            document.getElementById("district-precinct-chart-title").innerText = "Cluster";
        }
        else if (precinctBtn) {
            google.charts.setOnLoadCallback(function () {drawVotingChart(feature);});
            google.charts.setOnLoadCallback(function () {displayDemo(feature);});
            document.getElementById("district-precinct-chart-title").innerText = "Precinct";
        } else {
            google.charts.setOnLoadCallback(function () {drawVotingChart(feature);});
            google.charts.setOnLoadCallback(function () {displayDemo(feature);});
            document.getElementById("district-precinct-chart-title").innerText = "District";
        }
    }
}

function changeColor(){
    if(phase1Btn){
        changeMapData(mergedDistrctData);
    }else{
        if (precinctBtn){
            changeMapData(precinctsData);
        }else if (districtBtn){
            changeMapData(districtsData);
        }else{
            changeMapDataDependingOnZoomLevel();
        }
    }
}

function clearCharts() {
    if(phase1Btn){
        statePieChart.clearChart();
        stateBarChart.clearChart();
    }
    document.getElementById("district-precinct-chart-title").style.display = "none";
    pieChart.clearChart();
    barChart.clearChart();
}
